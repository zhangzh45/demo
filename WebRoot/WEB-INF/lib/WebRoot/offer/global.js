/*! global 2.0.1 pub 2016-06-03 14:07 by melkor */
define("public/global/2.0.1/global",["./user","jquery","cookie","events","./passport","./area","./weixin","./head","./where"],function(a,b,c){"use strict";var d=b;d.user=a("./user"),d.head=a("./head"),d.weixin=a("./weixin"),d.where=a("./where"),a.async("public/side/1.0.4/side",function(a){a.init()})}),define("public/global/2.0.1/user",["jquery","cookie","events","public/global/2.0.1/passport","public/global/2.0.1/area","public/global/2.0.1/weixin"],function(a,b,c){"use strict";var d=a("jquery"),e=a("cookie"),f=a("events"),g=a("public/global/2.0.1/passport"),h=b,i=window;f.mixTo(h);var j=e.get("uid"),k=e.get("username"),l=e.get("salt"),m=l&&"0"!==l||!1,n={uid:j||"",username:k||""};h.get=function(){return n},h.isLogin=function(){return m},h.passport=function(a,b){arguments.length<2&&(b=a||function(){},a={}),h.isLogin()?b(n):g.login(a,function(a){d.extend(n,a),m=!0,h.trigger("login",n),b(n)})},h.register=function(a,b){arguments.length<2&&(b=a||function(){},a={}),h.isLogin()?b(n):g.register(a,function(a){d.extend(n,a),m=!0,h.trigger("register",n),b(n)})},i.doLogin=function(){return h.isLogin()||h.passport(function(){i.location.reload()}),h.isLogin()},i.doRegister=function(a,b){return h.isLogin()||(arguments.length<2&&(b=a||function(){},a={}),h.register(a,function(a){d.extend(n,a),m=!0,b(n)})),h.isLogin()}}),define("public/global/2.0.1/passport",["jquery","cookie","public/global/2.0.1/area","public/global/2.0.1/weixin","events"],function(a,b,c){"use strict";function d(a,b){var c=b._popup;c.on({focus:function(){c.find(".input-text").removeClass("error").closest(".form-group").find(".form-err").empty()}},".input-text"),c.find(".input-text").off().on("input propertychange",function(){var a=v(this);""!==v.trim(a.val())?a.prev().hide():a.prev().show()}),c.on("click",".close",function(){b.close().remove(),V.stop()}),c.on("keydown",function(a){g(c,a)}),c.on("click",".loginButton",function(){j(c,a,b)}),c.on("click",".register",function(){log("send","click","register","click","\u6ce8\u518c")}),c.on("click",".J_uk",function(){h(c)}),V.on("loadQR",function(a){c.find(".qrcode-main").html('<img class="qrcode-img" alt="" src="'+a.code_url+'">'),c.find(".qrcode-desc").show(),c.find(".qrcode-help-main").show(),c.find(".qrcode-fail").hide(),c.find(".qrcode-login-success").hide()}),V.start(),V.on("fail",function(){c.find(".qrcode-desc").hide(),c.find(".qrcode-help-main").hide(),c.find(".qrcode-login-success").hide(),c.find(".qrcode-fail").show()}),V.on("succeed",function(){c.find(".qrcode-desc").hide(),c.find(".qrcode-help-main").hide(),c.find(".qrcode-fail").hide(),c.find(".qrcode-login-success").show()}),V.on("enter",function(d){v.ajax({type:"post",url:G,data:{weixincodekey:d.code_id},dataType:"jsonp",jsonp:"callBack",success:function(d){var e=d,f=e.result_code,g=e.weChatUserInfo,h={uid:g.third_uid,username:g.third_username,useravatar:g.third_img};if("300"===f){var i=c.find(".qrcode-form-popup");i.find('input[name="third_uid"]').val(h.uid),i.find('input[name="third_username"]').val(h.username),i.find('input[name="third_img"]').val(h.useravatar),i.find('input[name="returnUrl"]').val(B),log("send","click","log_in","weixin","\u767b\u5f55\u6d6e\u5c42"),i.submit()}else"200"===f?(a(h),b.close().remove(),V.stop(),log("send","click","log_in","weixin","\u767b\u5f55\u6d6e\u5c42")):"500"===f||"100"===f?(c.find(".qrcode-desc").hide(),c.find(".qrcode-help-main").hide(),c.find(".qrcode-login-success").hide(),c.find(".qrcode-fail").show()):"400"===f&&(window.location.href=R)}})}),f(c),e(c)}function e(a){a.find(".update-qrcode").on("click",function(){V.getCode()})}function f(a){a.on({mouseenter:function(){a.find(".qrcode-help-img").show()},mouseleave:function(){a.find(".qrcode-help-img").hide()}},".qrcode-help")}function g(a,b){var c=b?b:window.event?window.event:"",d=c.keyCode?c.keyCode:c.which;return 13==d?(a.find(".loginButton").trigger("click"),!1):!0}function h(a){var b=w.get("src");b=null===b?"":b;var c=w.get("referer");c=null===c?"":c;var d=Q+"?src="+b+"&referer="+c+"&returnUrl="+B;a.find(".uker-form").attr("action",d).attr("target","_blank").trigger("submit")}function i(a){var b=a.find('input[name="username"]'),c=a.find('input[name="password"]');return b.val().length<1?(b.addClass("error").closest(".form-group").find(".form-err").html("\u8bf7\u8f93\u5165\u7528\u6237\u540d/\u624b\u673a\u53f7"),!1):c.val().length<1?(c.addClass("error").closest(".form-group").find(".form-err").html("\u8bf7\u8f93\u5165\u5bc6\u7801"),!1):!0}function j(a,b,c){i(a)&&v.ajax({url:D,processData:!0,dataType:"jsonp",jsonp:"callBack",async:!1,type:"post",data:{username:a.find('input[name="username"]').val(),password:a.find('input[name="password"]').val()},success:function(d){var e=C+"/verifymobile.html";if(200===d.code||"200"===d.code){var f={username:d.data.username,nickname:d.data.nickname,useravatar:d.data.useravatar,uid:d.data.uid};b(f),c.close().remove(),log("send","click","log_in","weixin","\u767b\u5f55\u9875\u9762")}else 1*d.code===504||"ERROR_LOGIN_WITHOUT_VERIFYMOBILE"===d.code?window.location.href=e+"?returnUrl="+B:a.find('input[name="password"]').closest(".form-group").find(".form-err").html("\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef")},error:function(){a.find('input[name="password"]').closest(".form-group").find(".form-err").html("\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef")}})}function k(){var a='   <div class="dialog-login">     <div class="hd"><h5>\u767b\u5f55</h5><a class="close"></a></div>     <div class="bd">         <div class="quick-form"><form class="qrcode-form-popup" method="post" action="'+H+'" >   <input type="hidden" name="third_uid" >   <input type="hidden" name="third_username" >   <input type="hidden" name="third_img" >   <input type="hidden" name="returnUrl" >   <input type="hidden" name="type" value="wechat" >             <div class="qrcode-hd">\u5fae\u4fe1\u5feb\u901f\u767b\u5f55</div>             <div class="qrcode-main">             </div>             <div class="qrcode-desc">\u5fae\u4fe1\u626b\u7801\uff0c\u5feb\u901f\u767b\u5f55</div>             <div class="qrcode-fail">                 <i class="icon"></i>                 <strong>\u4e8c\u7ef4\u7801\u5931\u6548</strong>                 <span>\u8bf7\u70b9\u51fb<a class="update-qrcode">\u5237\u65b0\u4e8c\u7ef4\u7801</a></span>             </div>             <div class="qrcode-login-success">                 <i class="icon"></i>                 <strong>\u60a8\u5df2\u6210\u529f\u626b\u63cf\uff0c</strong>                 <span>\u8bf7\u5728\u5fae\u4fe1\u4e0a\u786e\u8ba4\u767b\u5f55</span>             </div>             <img src="http://s2.51offer.com/51offer/2015-07-31/help.png" class="qrcode-help-img">             <div class="qrcode-help-main"><a class="qrcode-help">\u4f7f\u7528\u5e2e\u52a9</a></div></form>         </div>         <div class="static-form">             <div class="form-group register">                     <a href="'+F+"?returnUrl="+B+'">\u514d\u8d39\u6ce8\u518c &gt;</a>             </div>             <div class="form-group">                 <div class="form-control">                     <label class="label-key" for="diaLoginUsername">\u7528\u6237\u540d/\u624b\u673a\u53f7</label>                     <input type="text" name="username" id="diaLoginUsername" class="input-text" maxlength="20">                     <i class="icon icon-person"></i>                 </div>                 <div class="form-err"></div>             </div>             <div class="form-group">                 <div class="form-control">                     <label class="label-key" for="diaLoginPassword">\u767b\u5f55\u5bc6\u7801</label>                     <input type="password" name="password" id="diaLoginPassword" class="input-text input-password" maxlength="20">                     <a class="icon icon-password"></a>                 </div>                 <div class="form-err"></div>             </div>             <div class="form-group">                 <a href="'+E+"?returnUrl="+B+'" class="forget-pwd">\u5fd8\u8bb0\u5bc6\u7801\uff1f</a>                 <a class="button loginButton">\u7acb\u5373\u767b\u5f55</a>             </div>             <form target="_blank" class="uker-form" action="" method="post">                 <dl class="entries">                     <dd>                         <a title="\u4e2d\u82f1\u7f51\u767b\u5f55" class="uk J_uk"><i class="icon icon-uk"></i>\u4e2d\u82f1\u7f51\u767b\u5f55</a>                     </dd>                 </dl>             </form>         </div>     </div> </div>';return a}function l(a,b,c){var d=b._popup;x.addStation(d.find(".dropdown-area").find(".dropdown-menu")),d.find(".input-text").each(function(){""!==this.value&&v(this).prev().hide()}),d.on("click",".dropdown-toggle",function(){v(this).parent().addClass("open")}),d.on("mouseleave",".dropdown-area",function(){v(this).removeClass("open")}),d.on("click",".dropdown-menu a",function(){var a=v(this),b=a.closest(".dropdown-area"),c=b.find(".dropdown-toggle");c.find("span").attr("data-val",a.attr("data-val")).html(a.html()),b.removeClass("open")}),d.on("click",".icon-eye-password",function(){var a=v(this),b="";a.hasClass("icon-eye-no-password")?(b=a.addClass("icon-eye-no-password").siblings("input").val(),a.removeClass("icon-eye-no-password").siblings("input").remove(),a.before('<input name="regist_password" type="password" class="input-text input-pwd" maxlength="20" id="registerPassword"/>'),a.siblings("input").val(b)):(b=a.addClass("icon-eye-no-password").siblings("input").val(),a.addClass("icon-eye-no-password").siblings("input").remove(),a.before('<input name="regist_password" type="text" class="input-text" maxlength="20" id="registerPassword"/>'),a.siblings("input").val(b)),d.find(".input-text").off().on("input propertychange",function(){var a=v(this);""!==v.trim(a.val())?a.prev().hide():a.prev().show()})}),d.on({focus:function(){d.find(".input-text").removeClass("error").closest(".form-group").find(".form-err").empty()}},".input-text"),d.find(".input-text").off().on("input propertychange",function(){var a=v(this);""!==v.trim(a.val())?a.prev().hide():a.prev().show()}),d.on("click",".registerButton",function(){n(d,b,c,function(){var e="00"+d.find(".dropdown-toggle span").attr("data-val"),f=d.find('input[name="regist_mobile"]').val(),g=d.find(".get-mobile-code").attr("data-code"),h=d.find('input[name="mobileCode"]').val(),i=d.find('input[name="regist_password"]').val(),j=d.find('input[name="code"]').val(),k=d.find(".verification").attr("data-key"),l={region:e,mobile:f,password:i,mobile_ddscode:g||"",mobile_code:h||"",key:k||"",code:j||"",status:c.status,isVerifyCode:c.isVerifyCode,src:window.__src__};v.ajax({type:"post",url:I,dataType:"jsonp",jsonp:"callBack",data:l,success:function(c){if(200===c.result_code||"200"===c.result_code){var d={uid:c.userMap.uid,username:c.userMap.username,nickname:c.userMap.nickname,useravatar:c.userMap.useravatar};a(d),b.close().remove()}else window.alert(c.result_msg)}})})}),d.on("keydown",function(a){m(d,a)}),d.on("click",".verification, .refresh",function(){v.ajax({type:"post",url:L,dataType:"jsonp",jsonp:"callBack",success:function(a){d.find(".verification").attr({src:M+"?session=register&key="+a,"data-key":a})}})}),d.find(".refresh").trigger("click"),d.on("click",".get-mobile-code",function(){return v(this).attr("disabled")?!1:void o(d,b)}),v("body").off().on("click",".get-voice",function(){return S=!0,v(".dropdown-area span").text().toString().match("86")?(v(v(this).parents(".form-group").css("position","relative").find("label")).text("\u8bf7\u8f93\u5165\u56db\u4f4d\u8bed\u97f3\u9a8c\u8bc1\u7801"),v(this).attr("disabled")?!1:void o(d,b)):(v(this).parents(".form-group").find(".form-err").text("\u56fd\u5916\u53f7\u7801\u8bf7\u5237\u65b0\u4f7f\u7528\u77ed\u4fe1\u901a\u9053"),!1)})}function m(a,b){var c=b?b:window.event?window.event:"",d=c.keyCode?c.keyCode:c.which;return 13==d?(a.find(".registerButton").trigger("click"),!1):!0}function n(a,b,c,d){o(a,b,c,d)}function o(a,b,c,d){var e=!0,f="00"+a.find(".dropdown-toggle span").attr("data-val"),g=a.find('input[name="regist_mobile"]'),h=g.val(),i=/^[0-9]*$/;""===h?(g.addClass("error").closest(".form-group").find(".form-err").html("\u8bf7\u8f93\u5165\u624b\u673a\u53f7"),e=!1):i.test(h)?"0086"===f?11===h.length?(i=/^0{0,1}(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])[0-9]{8}$/,i.test(h)||(g.addClass("error").closest(".form-group").find(".form-err").html("\u624b\u673a\u53f7\u5e94\u4e3a11\u4f4d\u6570\u5b57\uff0c\u4ee513/14/15/17/18\u5f00\u5934"),e=!1)):(g.addClass("error").closest(".form-group").find(".form-err").html("\u624b\u673a\u53f7\u5e94\u4e3a11\u4f4d\u6570\u5b57\uff0c\u4ee513/14/15/17/18\u5f00\u5934"),e=!1):"0086"!==f&&0===h.indexOf("0")&&(g.addClass("error").closest(".form-group").find(".form-err").html("\u56fd\u5916\u7528\u6237\u8bf7\u4e0d\u8981\u5728\u624b\u673a\u53f7\u524d\u52a00"),e=!1):(g.addClass("error").closest(".form-group").find(".form-err").html("\u624b\u673a\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e"),e=!1),e&&v.ajax({type:"post",url:K+"?region="+f+"&mobile="+h,dataType:"jsonp",jsonp:"callBack",success:function(e){if(2==e||3==e){var f='<a href="'+J+"?returnUrl="+B+'">\u767b\u5f55</a>';g.addClass("error").closest(".form-group").find(".form-err").html("\u624b\u673a\u53f7\u5df2\u5b58\u5728\uff0c\u8bf7\u76f4\u63a5"+f+"\u6216\u62e8\u6253400-6152-656\u54a8\u8be2")}else 1==e?g.addClass("error").closest(".form-group").find(".form-err").html("\u8bf7\u91cd\u65b0\u8f93\u5165\u624b\u673a\u53f7"):d?p(a,b,c,d):q(a,b)}})}function p(a,b,c,d){var e=a.find('input[name="regist_password"]'),f=e.val();""===f?e.addClass("error").closest(".form-group").find(".form-err").html("\u8bf7\u8f93\u5165\u5bc6\u7801"):f.length<6?e.addClass("error").closest(".form-group").find(".form-err").html("\u5bc6\u7801\u4e0d\u80fd\u5c11\u4e8e6\u4f4d"):q(a,b,c,d)}function q(a,b,c,d){var e=a.find('input[name="code"]'),f=e.val(),g=a.find(".verification");""===f?e.addClass("error").closest(".form-group").find(".form-err").html("\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"):v.ajax({type:"post",url:N+"?usertype=0&key="+g.attr("data-key")+"&code="+f,dataType:"jsonp",jsonp:"callBack",success:function(f){f?d?3===c.status?t(a,b,d):d():r(a):e.addClass("error").closest(".form-group").find(".form-err").html("\u9a8c\u8bc1\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\uff01")}})}function r(a){var b="00"+a.find(".dropdown-toggle span").attr("data-val"),c=a.find('input[name="regist_mobile"]').val(),d=a.find(".get-mobile-code").attr("data-code")||"",e=S?"&is_voice=1":"";if(d="",S&&(U=!1),!S){s(a.find(".get-mobile-code"));var f=v(".get-mobile-code"),g=setTimeout(function(){Z&&T&&clearTimeout(g);var a="<div class=\"form-err-voice\">\u6536\u4e0d\u5230\u77ed\u4fe1\uff1f\u4f7f\u7528<i class=\"get-voice\" style=\"color:blue;cursor:pointer\" onclick=\"log('send','click','register','get_verify_code','telephone')\">\u8bed\u97f3\u9a8c\u8bc1\u7801</i></div>";v(".dropdown-area span").text().toString().match("86")?(f.parents(".form-group").find(".form-err-voice").remove(),f.parents(".form-group").append(a)):v(".form-err-voice").remove()},15e3)}v.ajax({type:"post",url:O+"?region="+b+"&mobile="+c+"&name=&ddsCode="+d+e,dataType:"jsonp",jsonp:"callBack",success:function(b){a.find(".get-mobile-code").attr("data-code",b),v(".dropdown-area span").text().toString().match("86")&&S&&(v(".form-err-voice").empty(),v(".form-err-voice").html('<div>\u7535\u8bdd\u62e8\u6253\u4e2d\u2026\u8bf7\u7559\u610f\u63a5\u542c4006272606\u6765\u7535<i style="color:#3333EF;position:absolute;right:0%;top:59px" class="get-time"></i></div>'),s(v(".get-time"),function(){v(".form-err-voice").empty(),v(".form-err-voice").html("<div>\u91cd\u65b0\u83b7\u53d6<i style=\"cursor:pointer;color:#3333EF;\"class=\"get-voice\" onclick=\"log('send','click','register','get_verify_code','telephone')\">\u8bed\u97f3\u9a8c\u8bc1\u7801</i></div>")}))}})}function s(a,b){S&&a.text("60\u79d2\u540e\u91cd\u8bd5"),Y&&(v(".get-mobile-code").css("background","#ddd").attr("disabled","disabled").text("\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801"),clearInterval(Y),Y=void 0),a.attr("disabled","disabled");var c=60,d=setInterval(function(){!S&&a.text(c+"\u79d2\u540e\u91cd\u65b0\u83b7\u53d6"),S&&a.text(c+"\u79d2\u540e\u91cd\u8bd5"),v(".get-mobile-code").css("background","#ddd"),0>c&&(!S&&v(".get-mobile-code").css("background","#fff"),a.text("\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801"),clearInterval(d),a.removeAttr("disabled"),b&&b()),c--},1e3);a.hasClass("get-mobile-code")?Y=d:a.hasClass("get-voice")&&(S=!0,T=!1,Z=d)}function t(a,b,c){var d="00"+a.find(".dropdown-toggle span").attr("data-val"),e=a.find('input[name="regist_mobile"]').val(),f=a.find(".get-mobile-code").attr("data-code"),g=a.find('input[name="mobileCode"]'),h=g.val();return""===h?(g.addClass("error").closest(".form-group").find(".form-err").html("\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!1):void v.ajax({type:"post",url:P+"?region="+d+"&mobile="+e+"&code="+h+"&ddsCode="+f,dataType:"jsonp",jsonp:"callBack",success:function(a){a?c():g.addClass("error").closest(".form-group").find(".form-err").html("\u9a8c\u8bc1\u7801\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165")}})}function u(a){var b='<div class="dialog-register">';return a.close&&(b+='   <div class="hd"><a class="close" i="close"></a></div>'),b+='   <div class="bd">',""!==a.title&&(b+='       <div class="hd-tit">'+a.title+"</div>"),b+='       <div class="static-form">           <div class="form-group dropdown-control">               <div class="dropdown-area">                   <a class="dropdown-toggle">                       <b class="caret"></b>                       <span data-val="86">\u4e2d\u56fd + 0086</span>                   </a>                   <div class="dropdown-menu"></div>               </div>               <div class="form-control">                   <label for="registerMobile" class="label-key">'+a.registerMobile_title+'</label>                   <input type="text" maxlength="11" class="input-text input-pwd" name="regist_mobile" id="registerMobile" value="'+a.mobile+'">                   <i class="icon icon-telephone"></i>               </div>               <div class="form-err"></div>           </div>           <div class="form-group pwd-control">               <div class="form-control">                   <label for="registerPassword" class="label-key">'+a.registerPassword_title+'</label>                   <input type="password" maxlength="20" class="input-text" name="regist_password" id="registerPassword">                   <i class="icon icon-eye-password"></i>               </div>               <div class="form-err"></div>           </div>           <div class="form-group code-control">               <div class="form-control">                   <label for="registerCode" class="label-key">'+a.registerCode_title+'</label>                   <input type="text" maxlength="4" class="input-text" name="code" id="registerCode">                   <img class="verification">               </div>               <a class="refresh">\u6362\u4e00\u5f20</a>               <div class="form-err"></div>           </div>',3===a.status&&(b+='           <div class="form-group code-control">               <div class="form-control">                   <label for="registerMobileCode" class="label-key">\u8bf7\u8f93\u5165\u56db\u4f4d\u77ed\u4fe1\u9a8c\u8bc1\u7801</label>                   <input type="text" class="input-text" name="mobileCode" id="registerMobileCode">               </div>               <a class="get-mobile-code" onclick="log(\'send\',\'click\',\'register\',\'get_verify_code\u2019,\u2019message\u2019)">\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801</a>               <div class="form-err"></div>           </div>'),b+='           <div class="form-group">               <a class="button registerButton">'+a.button_title+'</a>           </div>           <div class="form-group login-bar">\u5df2\u670951offer\u5e10\u53f7\uff1f<a href="'+J+"?returnUrl="+B+'">\u8bf7\u767b\u5f55</a></div>       </div>   </div></div>'}var v=a("jquery"),w=a("cookie"),x=a("public/global/2.0.1/area"),y=a("public/global/2.0.1/weixin"),z=b,A=window.root_domain,B=window.location.href,C="http://account."+A,D=C+"/ajaxlogin.html",E=C+"/forgot/forgotpassword.html",F=C+"/register.html",G=C+"/third/aJaxWeChatLogin.html",H=C+"/third/bind.html",I=C+"/ajaxRegister.html",J=C+"/login.html",K=C+"/user/checkMobile.html",L=C+"/user/getPageVerifyCode.html",M=C+"/imageServlet",N=C+"/user/checkPageVerifyCode.html",O=C+"/sms/setVerifyCode.html",P=C+"/sms/verifyCodeFlag.html",Q=C+"/third/ukerLogin.html",R=C+"/user/setPassword.html",S=!1,T=!0,U=!0,V=new y;V.init();var W={return_url:B};z.login=function(b,c){var e=v.extend({},W,b);B=encodeURIComponent(e.return_url),a.async(["gallery/dialog/6.0.5/dialog","public/global/2.0.1/passport.css"],function(a){var b=k(),e=new a({title:!1,content:b,padding:0});e.showModal(),d(c,e)})};var X={esc:!0,close:!0,skin:"dialog-register",title:"\u6ce8\u518c",button_title:"\u6ce8\u518c51offer",registerMobile_title:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",registerPassword_title:"\u8bf7\u8f93\u5165\u5bc6\u7801",registerCode_title:"\u9a8c\u8bc1\u7801",mobile:"",return_url:B,status:3,isVerifyCode:1};z.register=function(b,c){var d=v.extend({},X,b);B=encodeURIComponent(d.return_url),a.async(["gallery/dialog/6.0.5/dialog","public/global/2.0.1/passport.css?a=1"],function(a){var b=u(d),e=new a({title:!1,content:b,padding:0,skin:d.skin});e.showModal(),d.esc||v(document).off("keydown",e._esc),l(c,e,d)})};var Y,Z}),define("public/global/2.0.1/area",["jquery"],function(a,b,c){"use strict";var d=a("jquery"),e=b,f=[{letter:"z",name:"\u4e2d\u56fd",code:86},{letter:"y",name:"\u82f1\u56fd",code:44},{letter:"m",name:"\u7f8e\u56fd",code:1},{letter:"a",name:"\u6fb3\u5927\u5229\u4e9a",code:61},{letter:"j",name:"\u52a0\u62ff\u5927",code:1},{letter:"x",name:"\u9999\u6e2f",code:852},{letter:"a",name:"\u6fb3\u95e8",code:853},{letter:"t",name:"\u53f0\u6e7e",code:886},{letter:"b",name:"\u5df4\u6797",code:973},{letter:"b",name:"\u6bd4\u5229\u65f6",code:32},{letter:"b",name:"\u4fdd\u52a0\u5229\u4e9a",code:359},{letter:"d",name:"\u4e39\u9ea6",code:45},{letter:"a",name:"\u7231\u6c99\u5c3c\u4e9a",code:372},{letter:"d",name:"\u5fb7\u56fd",code:49},{letter:"b",name:"\u51b0\u5c9b",code:354},{letter:"a",name:"\u7231\u5c14\u5170",code:353},{letter:"b",name:"\u5df4\u52d2\u65af\u5766",code:972},{letter:"b",name:"\u6ce2\u5170",code:48},{letter:"a",name:"\u963f\u62c9\u4f2f",code:971},{letter:"a",name:"\u5965\u5730\u5229",code:43},{letter:"a",name:"\u57c3\u53ca",code:20},{letter:"h",name:"\u8377\u5170",code:31},{letter:"k",name:"\u5361\u5854\u5c14",code:974},{letter:"l",name:"\u7f57\u9a6c\u5c3c\u4e9a",code:40},{letter:"f",name:"\u82ac\u5170",code:358},{letter:"f",name:"\u6cd5\u56fd",code:33},{letter:"f",name:"\u83f2\u5f8b\u5bbe",code:63},{letter:"e",name:"\u4fc4\u7f57\u65af",code:7},{letter:"h",name:"\u97e9\u56fd",code:82},{letter:"j",name:"\u67ec\u57d4\u5be8",code:855},{letter:"j",name:"\u6377\u514b",code:420},{letter:"j",name:"\u52a0\u7eb3",code:233},{letter:"k",name:"\u80af\u5c3c\u4e9a",code:254},{letter:"n",name:"\u5c3c\u65e5\u5229\u4e9a",code:234},{letter:"m",name:"\u5b5f\u52a0\u62c9\u56fd",code:880},{letter:"m",name:"\u9a6c\u6765\u897f\u4e9a",code:60},{letter:"m",name:"\u6bdb\u91cc\u6c42\u65af",code:230},{letter:"m",name:"\u8499\u53e4",code:976},{letter:"n",name:"\u632a\u5a01",code:47},{letter:"p",name:"\u8461\u8404\u7259",code:351},{letter:"n",name:"\u5357\u975e",code:27},{letter:"k",name:"\u79d1\u7279\u8fea\u74e6",code:225},{letter:"k",name:"\u79d1\u5a01\u7279",code:965},{letter:"l",name:"\u62c9\u8131\u7ef4\u4e9a",code:371},{letter:"l",name:"\u9ece\u5df4\u5ae9",code:961},{letter:"l",name:"\u7acb\u9676\u5b9b",code:370},{letter:"l",name:"\u5362\u68ee\u5821",code:352},{letter:"r",name:"\u65e5\u672c",code:81},{letter:"r",name:"\u745e\u5178",code:46},{letter:"r",name:"\u745e\u58eb",code:41},{letter:"s",name:"\u585e\u5185\u52a0\u5c14",code:221},{letter:"s",name:"\u65af\u6d1b\u4f10\u514b",code:421},{letter:"t",name:"\u6cf0\u56fd",code:66},{letter:"t",name:"\u571f\u8033\u5176",code:90},{letter:"x",name:"\u5e0c\u814a",code:30},{letter:"x",name:"\u897f\u73ed\u7259",code:34},{letter:"x",name:"\u5308\u7259\u5229",code:36},{letter:"x",name:"\u65b0\u897f\u5170",code:64},{letter:"y",name:"\u5370\u5ea6",code:91},{letter:"y",name:"\u5370\u5c3c",code:62},{letter:"y",name:"\u610f\u5927\u5229",code:39},{letter:"y",name:"\u82f1\u56fd",code:44},{letter:"y",name:"\u8d8a\u5357",code:84},{letter:"x",name:"\u65b0\u52a0\u5761",code:65},{letter:"w",name:"\u4e4c\u514b\u5170",code:380},{letter:"s",name:"\u65af\u91cc\u5170\u5361",code:94},{letter:"s",name:"\u585e\u6d66\u8def\u65af",code:357},{letter:"e",name:"\u5384\u74dc\u591a\u5c14",code:593},{letter:"e",name:"\u7eb3\u7c73\u6bd4\u4e9a",code:264}];e.addStation=function(a){var b="";d.each(f,function(){b+='<a data-val="'+d(this)[0].code+'">'+d(this)[0].name+" + 00"+d(this)[0].code+"</a>"}),a.html(b)}}),define("public/global/2.0.1/weixin",["jquery","events"],function(a,b,c){"use strict";function d(a){f.ajax({type:"get",url:a.ops.getCodeStatusUrl,data:{weixincodekey:a.id},dataType:"jsonp",jsonp:"callBack",success:function(b){var c=b.result_code;"500"==c||"1"==c||"0"==c?a.ev.trigger("fail",{error:c,msg:b.result_msg}):"2"==c?e(a):"3"==c?(0===a.n&&(a.number=0,a.n=1),e(a),a.ev.trigger("succeed",{code_id:a.id,msg:"\u5df2\u626b\u63cf\u6210\u529f"})):"4"==c?a.ev.trigger("enter",{code_id:a.id,msg:"\u5b8c\u6210\u767b\u5f55"}):a.ev.trigger("fail",{error:c,msg:"\u4e8c\u7ef4\u7801\u5df2\u8fc7\u671f\uff0c\u8bf7\u5237\u65b0"})},error:function(){a.ev.trigger("fail",{error:"\u4e8c\u7ef4\u7801\u5df2\u5931\u6548\uff0c\u8bf7\u5237\u65b0"})}})}function e(a){if(31!=a.number){if(a.state)var b=2,c=setInterval(function(){0>b&&(clearInterval(c),d(a),a.number++),b--},1e3)}else a.ev.trigger("fail",{error:"\u4e8c\u7ef4\u7801\u5df2\u5931\u6548\uff0c\u8bf7\u5237\u65b0"})}var f=a("jquery"),g=a("events"),h=window.root_domain,i={getCodeUrl:"http://account."+h+"/third/getWeChatCode.html",getCodeStatusUrl:"http://account."+h+"/third/getWeChatStatus.html"},j=function(){var a=this;a.config=i,a.number=0,a.state=!0,a.id="",a.n=0,a.ops="",a.ev=new g};j.prototype.init=function(a){var b=this;b.ops=f.extend({},b.config,a)},j.prototype.on=function(){this.ev.on.apply(this.ev,arguments)},j.prototype.off=function(){this.ev.off.apply(this.ev,arguments)},j.prototype.getCode=function(){var a=this;f.ajax({type:"get",url:a.ops.getCodeUrl,data:{},dataType:"jsonp",jsonp:"callBack",success:function(b){if(0!==b){var c=b.wechatcode_id,e=b.wechatcode_url;a.id=c,a.state=!0,a.number=0,a.n=0,d(a),a.ev.trigger("loadQR",{code_id:c,code_url:e})}},error:function(){}})},j.prototype.start=function(){this.getCode()},j.prototype.stop=function(){this.state=!1},c.exports=j}),define("public/global/2.0.1/head",["jquery","cookie","public/global/2.0.1/user","events","public/global/2.0.1/passport","public/global/2.0.1/area","public/global/2.0.1/weixin","public/global/2.0.1/where"],function(a,b,c){"use strict";function d(){j.ajax({type:"post",dataType:"jsonp",jsonp:"callBack",url:v,success:function(a){if(1===a){var b='<div style="opacity: 0.7; background: rgb(0, 0, 0) none repeat scroll 0% 0%; position: fixed; left: 0px; top: 0px; width: 100%; height: 100%; overflow: hidden; -moz-user-select: none; z-index: 1025;" tabindex="0" class="ui-popup-backdrop"></div><div style="position: absolute;left: 142px;top: 0px;margin-left: 50%; width: 408px;height: 298px; z-index:1026; background:url(http://s2.51offer.com/51offer/img/2015-10-27/top-hint2.png) no-repeat;"><div style="position: absolute; left: 152px; top: 240px; width: 110px; height: 43px; cursor: pointer;" class="top-hint-botton">&nbsp;</div></div>';j("body").append(b),j(".top-hint-botton").click(function(){j(".ui-popup-backdrop").remove(),j(this).parent().remove()})}}})}function e(a){var b=a.find(".nav-weixin-login");return b.length?(x.on("loadQR",function(a){b.find('input[name="weixincodekey"]').val(a.code_id),b.find(".qrcode-main").html('<img class="qrcode-img" alt="" src="'+a.code_url+'">'),b.find(".qrcode-desc").show(),b.find(".qrcode-help-main").show(),b.find(".qrcode-fail").hide(),b.find(".qrcode-login-success").hide()}),x.on("fail",function(){b.find(".qrcode-desc").hide(),b.find(".qrcode-help-main").hide(),b.find(".qrcode-login-success").hide(),b.find(".qrcode-fail").show()}),x.on("succeed",function(){b.find(".qrcode-desc").hide(),b.find(".qrcode-help-main").hide(),b.find(".qrcode-fail").hide(),b.find(".qrcode-login-success").show()}),x.on("enter",function(){b.find(".qrcode-form").submit(),log("send","click","log_in","weixin","\u5feb\u901f\u767b\u5f55")}),b.on({mouseenter:function(){x.start()},mouseleave:function(){x.stop(),b.find(".qrcode-main").html("")}}),b.find('input[name="returnUrl"]').val(q),g(b),void f(b)):!1}function f(a){a.find(".update-qrcode").on("click",function(){x.getCode()})}function g(a){a.on({mouseenter:function(){a.find(".qrcode-help-img").show()},mouseleave:function(){a.find(".qrcode-help-img").hide()}},".qrcode-help")}function h(a){var b=j(".global-header");if(b.find(".i-user").on("mouseenter",function(){return j(this).find(".dropdown-menu").show(),!1}).on("mouseleave",function(){return j(this).find(".dropdown-menu").hide(),!1}),b.find(".logout-btn").attr("href",b.find(".logout-btn").attr("href")+"?returnUrl="+q),b.find(".user-img").attr("src",s+a.uid+".jpg?imageView/2/w/24/h/24"),b.find(".u-name").html(a.username),b.find(".logout-btn").on("click",function(){k.set("is_show_email","",{path:"/",domain:"51offer.com"})}),w){var c=k.get("is_show_email")||"";""===c?j.ajax({type:"get",url:"http://www."+p+"/apichannl/isShowEmail.html",dataType:"jsonp",jsonp:"callBack",success:function(a){0===a?(k.set("is_show_email",0,{path:"/",domain:"51offer.com"}),j(".i-letter").hide()):(k.set("is_show_email",1,{path:"/",domain:"51offer.com"}),j(".i-letter").show())}}):0===c||"0"===c?j(".i-letter").hide():(1===c||"1"===c)&&j(".i-letter").show()}else j(".i-letter").hide()}function i(){function a(a){1==a?(j(".input-group .icons-search").css({borderColor:"#87aefc"}),j(".global-pi-pei").show()):(j(".input-group .icons-search").css("borderColor","#e2e8ee"),j(".global-pi-pei").hide())}function b(){var a=j("#global-cname").val();log("send","search","SearchSchool",j.trim(a),""),window.open("http://www."+p+"/school/uk-all-1.html?cname="+j.trim(a)+"#frm1")}j("body").on("click",function(){a(2)}),j(".global-search-input").on("click",".btn-search",b).on("keydown","#global-cname",function(a){13==a.keyCode&&b()}).on("click","#global-cname",function(){return!1}).on("focus","#global-cname",function(){"\u641c\u7d22\u4f60\u611f\u5174\u8da3\u7684\u5b66\u6821"==this.value&&(this.value=""),j(this).css("color","#000"),j(this).siblings(".submit").css("backgroundPosition","0px -37px")}).on("blur","#global-cname",function(){""===this.value&&(j(this).css("color","#aaa"),j(this).siblings(".submit").css("backgroundPosition","0px -3px"),j(this).val("\u641c\u7d22\u4f60\u611f\u5174\u8da3\u7684\u5b66\u6821"))}).on("click",".global-pi-pei a",function(){var b=j(this).html(),c=j(this).attr("data-url"),d=j("#global-cname");return null!==b&&""!==b&&"\u672a\u641c\u7d22\u5230\u76f8\u5173\u5b66\u6821"!==b?(log("send","search","SearchSchool",j.trim(d.val()),b),d.val(b).css("color","#000").focus(),a(2),window.open("http://www."+p+"/school/"+j.trim(c)+".html")):a(2),!1}),j("#global-cname").on("input propertychange",function(){var b=j(this).val();j.ajax({type:"get",url:u,data:{cname:b},success:function(a){var b=j(".global-pi-pei"),c="";if(0!==a){for(var d=a,e=0;e<d.length;e++)5>e&&(c=c+"<a title='"+d[e].cname+"' data-url='"+d[e].urlkey+"'>"+d[e].cname+"</a>");b.children().remove(),b.append(c)}else c="<a>\u672a\u641c\u7d22\u5230\u76f8\u5173\u5b66\u6821</a>",b.children().remove(),b.append(c)}}),a(1)})}var j=a("jquery"),k=a("cookie"),l=a("public/global/2.0.1/user"),m=a("public/global/2.0.1/where"),n=a("public/global/2.0.1/weixin"),o=b,p=window.root_domain,q=encodeURIComponent(window.location.href),r="http://www."+p,s="http://s2.51offer.com/common/user/avatar/",t=encodeURIComponent(r+"/start-diy.html"),u="http://www."+p+"/school/schoolName.html",v="http://account."+p+"/user/alertWebRenewal.html",w=!1,x=new n;
x.init(),o.init=function(){var a=j(".global-header");o.initLogin();for(var b in m)if(m[b]){a.find(".n-"+b).addClass("active");break}e(a),j(function(){var a=j("body").attr("class");if(a)for(var b=a.split(" "),c=0;c<b.length;c++)0===b[c].indexOf("page-")&&j(".n-sub-"+b[c].replace("page-","")).addClass("nav_active");i()})},o.initLogin=function(){w=l.isLogin();var a=j(".global-header");if(w)h(l.get()),a.find(".nav-login").hide(),a.find(".nav-logined").show(),d();else{var b=a.find(".nav-login-btn"),c=a.find(".nav-register-btn");if(b.length&&c.length){var e=b.attr("href"),f=c.attr("href"),g=m.home?t:q,i=-1!=f.indexOf("returnUrl"),k=-1!=e.indexOf("returnUrl");k||a.find(".nav-login-btn").attr("href",e+"?returnUrl="+q),i||a.find(".nav-register-btn").attr("href",f+"?returnUrl="+g)}a.find(".nav-weixin-login").show(),a.find(".nav-login").show(),a.find(".nav-logined").hide()}},o.initSimpleLogin=function(a){var b=j(".global-header");h(a),b.find(".nav-weixin-login").hide(),b.find(".nav-login").hide(),b.find(".nav-logined").show(),d()},l.on("login",function(a){o.initSimpleLogin(a)}),l.on("register",function(a){o.initSimpleLogin(a)})}),define("public/global/2.0.1/where",[],function(a,b,c){"use strict";var d=window.location,e=d.host,f=d.pathname,g=e.substring(0,e.indexOf(".")),h="www"==g&&/^\/(index\.html)?$/i.test(f),i="www"==g&&/^\/school\//i.test(f),j="www"==g&&/^\/wenda\//i.test(f),k="www"==g&&/^\/article\//i.test(f),l="www"==g&&!j&&!i&&!k&&/^\/(?!index)[a-z\.\-_\/]+$/i.test(f),m="mall"==g&&/^\/fang\//i.test(f),n="mall"==g&&!m,o="study"==g;return{home:h,apply:l,fang:m,mall:n,school:i,article:k,q:j,ys:o}});
